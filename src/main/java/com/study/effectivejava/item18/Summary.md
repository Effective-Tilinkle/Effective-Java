# 상속보다는 컴포지션을 사용하라

- 상속은 재사용하는 강력한 수단이지만, 항상 최선은 아니다.
  - 인터페이스 상속이 아님, 클래스를 확장하는 구현상속을 말함

### 상속의 문제점
1. 메소드 호출과 달리 상속은 캡슐화를 깨트림
   - ex) p115 HashSet예제
2. 상위 클래스의 API를 그 결함까지도 그대로 계승한다.
3. 상속은 캡슐화를 해친다.

### 문제점 회피 방법
- 기존 클래스 확장하는 대신, 새로운 클래스를 만들고 private필드로 기존클래스의 인스턴스를 참조하게 하자
  - 이를 컴포지션이라 한다.
    - 새 클래스의 인스턴스 메서드들이 기존클래스에 대응하는 메서드를 호출해 그 결과를 반환 하는 것을 forwarding
    - 이 전달 메서드들을 forwarding메서드라 함


- 컴포지션과 전달의 조합은 넓은 의미로 위임이라고 부른다.
  - 엄밀히 따지면 래퍼 객체가 내부 객체에 자기 자신의 참조를 넘기는 경우만 위임에 해당한다


### 래퍼 클래스 단점
- 콜백프레임워크와 어울리지 않음
  - 콜백프레임워크에서는 자기 자신의 참조를 다른 객체에 넘겨서 다음 호출 때, 사용하도록 한다.
- 내부 객체는 자신을 감싸고 있는 래퍼의 존재를 모르니 대신 자신(this)의 참조를 넘기고, 콜백 때는, 래퍼가 아닌 내부 객체를 호출하게 된다. 이를 SELF 문제라고 한다.


- **상속은 반드시 하위 클래스가 상위 클래스의 '진짜' 하위 타입인 상황에서만 쓰여야 한다.**

## 상속 사용 시, 자문해야할 것
1. 확장하려는 클래스의 API에 아무런 결함이 없는가?
2. 결함이 있다면 전파돼도 괜찮은가?
3. is-a관계일 때만 사용할 것


## Question
1. 콜백프레임워크?